# Решение проблемы "Email not confirmed"

## Проблема

При попытке войти появляется ошибка **"Email not confirmed"**. Это происходит потому, что в Supabase включено требование подтверждения email перед входом.

---

## Решение 1: Отключить подтверждение email (для разработки)

### Шаг 1: Откройте настройки аутентификации в Supabase

1. Войдите в [Supabase Dashboard](https://supabase.com/dashboard)
2. Выберите ваш проект
3. Перейдите в **Authentication** → **Settings** (или **Settings** → **Auth**)

### Шаг 2: Отключите подтверждение email

Найдите секцию **"Email Auth"** или **"Email"**:

1. Найдите опцию **"Enable email confirmations"** или **"Confirm email"**
2. **Отключите** эту опцию (снимите галочку)
3. Нажмите **"Save"** или **"Update"**

### Шаг 3: Подтвердите существующих пользователей (если нужно)

Если у вас уже есть пользователи, которые не подтвердили email, выполните в SQL Editor:

```sql
-- Подтвердить всех пользователей
UPDATE auth.users
SET email_confirmed_at = NOW()
WHERE email_confirmed_at IS NULL;
```

---

## Решение 2: Включить подтверждение email (для продакшена)

Если вы хотите оставить подтверждение email включенным:

### Шаг 1: Настройте email в Supabase

1. Перейдите в **Settings** → **Auth** → **Email Templates**
2. Настройте шаблон письма для подтверждения
3. Или используйте SMTP для отправки писем

### Шаг 2: Обновите страницу регистрации

После регистрации пользователь должен получить письмо с подтверждением. Добавьте сообщение на странице регистрации.

---

## Решение 3: Автоматическое подтверждение для разработки (SQL)

Если вы хотите автоматически подтверждать всех новых пользователей в разработке:

1. Выполните SQL из файла `supabase/05_auto_confirm_email.sql` в Supabase SQL Editor
2. Это создаст триггер, который автоматически подтверждает email при регистрации
3. Также подтвердит всех существующих пользователей

⚠️ **Внимание**: Используйте это только для разработки! В продакшене это небезопасно.

### Подтверждение только существующих пользователей

Если нужно подтвердить только существующих пользователей (без создания триггера), выполните:
- `supabase/06_confirm_existing_users.sql`

---

## Рекомендация

Для **разработки и тестирования** используйте **Решение 1** (отключить подтверждение email).

Для **продакшена** используйте **Решение 2** (настроить отправку писем).

---

## Проверка

После применения решения:

1. Попробуйте зарегистрироваться заново
2. Попробуйте войти
3. Ошибка "Email not confirmed" больше не должна появляться

